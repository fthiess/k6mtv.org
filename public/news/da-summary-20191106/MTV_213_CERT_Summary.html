<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=iso-8859-1">
<title>ARES/RACES MESSAGE FORM</TITLE>
<!-- Message Form Ver 2.3.5, 02/13/12: for auto save with OpDirect and
     some numbered statements, replyby textbox.
     Mountain View CERT/Universal Message Form, ver 1.7, 02/13/12
     Removed requirement to check send/received and how sent, 11/05/07
     Set Font color RED for required input - 11/11/07
     Added limit print feature, 10/17/09
     Added Bold Stylesheet command for form fields, 11/8/09
     Added feature to count Textarea lines and expand rows if required, 2/7/10.
     Added reply button and blocked extranious text for printing.
     4/16/10 - Added: Datetime call in resetforms, upcase msg nos.;
     7/19/10 - Blured message Nos.
     12/03/10 - Added Query String function to accept parameters as a test
     01/10/11 - Added Dropdown option for To and From ICS Positions
     01/11/11 - Added "hr1 = "0".hr1;" to datetime function if hr1<10.
     01/11/11 - Added parameter to datetime so  that operator date/time is updated
                upon submit, but not date/time at top of form.
     01/12/11 - Updated text in ICS To/From butons, added text at Op. time/date.
     01/14/11 - Fixed odate, otime (lower right of form) to be uneditable, but
                updated when form is submitted. (Add PR34 to # ver. rec.)
     01/15/11 -Added test to NOT print empty fields, removed non-essential # records.
     04/24/11 - Added code to geturl() to eliminate CGI info
     10/24/11 - Updated Generic CERT version of message form
     02/12/12 - Added style:display IDs to display ordate and ortime from outpost.
     01/11/13 - Added JSid & JSver and fixed the Clark '<' fields.
     07/22/13 - Modified textarea LF flag from Inv. ? to \n for 7 bit problem
     07/22/13 - Changed trim: user '] to ''] and ] to ']; all reversed thru pac-read
     07/22/13 by HPH, added a fix to trim to add a blank to the end of the string if a
        backtick is the last character
     07/23/12 by HPH, Added command to unwrap to convert inverted ? to \n for input from old forms
     08/11/13 by HPH, added treply for trim and reply feature.
     10/1/14 by HPH, change Receiving to Receiver's in "When Sending Message" msg. no, field
     10/27/14 by HPH, Fixed typo "Senders's" to "Sender's"
     01/11/15 by HPH, Fixed JS function geturl to remove problem with a slash in Outpost ID user name
     04/27/15 by HPH. Added capability to use WS<n> as a Tactical ID so that the From Location can be filled in.
     08-21-14 by HPH, Updated CERT Dropdown list.
     11-11-15 by HPH, Cert list modified to remove fire stations.
     11-05-16 by HPH, Cert list, added Gemello on Dropdown list.
     11-08-16 by HPH, Added 'MV' to title of form
     08-13-18 by HPH, Added test to location where the DA summary values are put into the message area
                      so that only one copy of that info. is put there.
     09-19-18 by HPH, Removed a redundant call to wrap() for the message area after loading
                      the DA messages into that area.  It is done in listels().
     05-09-19 by HPH  Changed toe PacRELEASE 4.7 from 4.4
     10-20-19 by HPH  Added Shoreline Rengsorff to CERT list.
     11-05-19 by HPH  Changed name to Rengstorff/Shoreline.
     01-22-20 by HPH  Modified Instructions in function checkmsgno to instruct the user how
                      to correctly set up the Tactical and Message ID in Station ID.
                      Also, in the HELP instructions, 3rd Paragraph, has been modified to
                      clairfy setting up Tactical and Message IDs Settings->Station ID.
 -->
<style type="text/css">
  table { font-weight:normal; font-size:8pt; font-family:Times New Roman,Serif }
  #certstuff{ font-weight:bold; font-size:9pt; font-family:Times New Roman,Serif }
  #button, #fmbutton { font-weight:bold; font-size:9pt; font-family:Times New Roman,Serif }
  input, select {background:#ffffbb }
  textarea {background:#ffffbb }
  #tidt { background:#eeeeee }
  input,textarea, select { font-weight:bold; }
  .reply{ background-color: yellow; display:none;}
</style>
<style type="text/css" media="print">
  .header, .trailer { display: none;  }
</style>
<script language="JavaScript">
// <!--
var JSid = "MTV 213 CERT SUMMARY (which4)";
var JSver = "JS-ver. MV/PR-4.7-3.6, 01/23/20";
var JShead =  "Mtn. View 213 CERT Summary Form (Ver. MV/PR-4.7-3.6, 01/23/20)-<b>PacRELEASE 4.7</b>";
var JStail = "<b><u>FORM 213 MTV CERT Summary (Ver. MV/PR-4.7-3.6)</u>, 01/23/20</b>";

function lockUnlockMsg(checkbox) {
     if (checkbox.checked == 1)
        { document.getElementById('RSmsgno').disabled = false;
          document.getElementById('SRmsgno').disabled = false;
        }
     else
        { document.getElementById('RSmsgno').disabled = true;
          document.getElementById('SRmsgno').disabled = true;
        }
 }

function emerg()
  { document.forms[0].handling[0].checked=true;
  }

 var whichway, ascii, thisurl;
 thisurl = "";
 function geturl()
  { if (thisurl != "") { return thisurl; }
    var res = new Array(), tem = new Array();
    var a=document.URL;
    tem = a.split(/\?/);
  //  alert(a+", T0:"+tem[0]+", T1:"+tem[1]);
    a = tem[0];
    a = a.replace(/\\/g,"\/");
    res = a.split(/\//g);
    var l = res.length-1;
  //  alert(a+", "+l+", "+res[0]+","+res[l]);
    return res[l];
  }


 function resetforms()
  { document.forms[0].reset();
    document.forms[1].reset();
    datetime(0);  // added 4/17/10
  }

 function hide_message()
  {
    document.getElementById('errormessage1').style.display='none';
  }

 function Browser()
  { var bb = navigator.appName;
    if (bb.indexOf("Microsoft") != -1)
    {
      return true;
    }
    else
    {
      return false;
    }
  }

      function zerofill(val)
       { if (val > 9) { return "" + val }
         return "0" + val
       }

      function datetime(dum1)  // Parameter added 1/11/11 to update Operator send date/time
       { var hr, ampm;
         var Today = new Date();
         var month = zerofill(Today.getMonth()+1);
         var year = Today.getFullYear();
         var day  = zerofill(Today.getDate());
         var hr1 = Today.getHours();
         var min = zerofill(Today.getMinutes());
/*
         if (hr1 >12)
          { hr = hr1 - 12;
            ampm = " PM";
          } else
          { hr = hr1;
            ampm = " AM";
          }
*/
         hr1 = zerofill(hr1);
         var dat = month+"/"+day+"/"+year;
         var tim = hr1+":"+min;
         if (dum1 == 0)
          { document.forms[0].date.value=dat;
            document.forms[0].time.value=tim;
          } else
         if(dum1 == 1)
          { document.forms[0].odate.value=dat;
            document.forms[0].otime.value=tim;
          } else
         if (dum1 == 2)
          { document.forms[0].odate.value="";
            document.forms[0].otime.value="";
          }
       }
   var treply = 0;
   function trim(strval)              // Trims leading and trailing blanks
   { if (treply == 0)
      { strval = strval.replace(/\`\]/g, "\x87")  // New - temp.
        strval = strval.replace(/\]/g, "`]");     // New
        strval = strval.replace(/\x87/g, "``]");  // New
      }
     strval = strval.replace(/\s*$/,"");
     strval = strval.replace(/^\s*/,"");
     strval = strval.replace(/\`$/,"` ");  // adds a last backtick with backtick blank
     return strval;
   }

 function wrap(inStr, cols)
  { var i, n, itot, str, res, cvt;
    words = new Array;
    if (inStr == "") { return inStr; }
    if (cols < 0)
     { cols=Math.abs(cols);
//       inStr = inStr.replace(/%BF/g, "%37BF");  // removes %BF typed by user NEW
//       inStr = inStr.replace(/\n/g,"\xBF");   // Inverted ?
       inStr = inStr.replace(/\n/g,"\\n");      //NEW
       inStr = inStr.replace(/\r/g,"");
//       inStr = "\xBF"+inStr;                  // Inverted ?
       inStr = "\\n"+inStr;                    // NEW
     } else
     { inStr = inStr.replace(/\n|\r/g, " ");
     }
    words = inStr.split(" ");
    iwd = words.length;
    n = inStr.length;
    i = 0;
    k = 0;
    res = "";
    blk = "";
    itot = 0;
    for (i=0; i<iwd; i++)
     { if (itot >= cols)
        { words[i] = words[i]+"\n";
          itot = 0;
        }
       itot = itot + words[i].length + 1;
       res = res + blk + words[i];
       blk = " ";
     }
    return res;
  }

   var itot;
   function unwrap(str,msg)
    { var i, n, nl, iwd, k;
      words = new Array;
      icols = msg.cols;
      irows = msg.rows;
      str = str.replace(/\xBF/g,"\\n");  // Converts all inverted ? to \n from old versions, 7/23/13
      str = str.replace(/\\n/g, "\n");
//      str = str.replace(/%37/g, "%");     // NEW
      if (str.charAt(0) == "\n")      // Removes inverted \n at 1st Chr.
       { str = str.substring(1); }
      parl = countlines(str);
      tsl = str.length;
      nrows = Math.ceil(tsl/icols);
      words = str.split(" ");
      iwd = words.length;
      n = str.length;
  //    if (n <= icols) { return inStr }
      i = 0;
      k = 0;
      nl = 0;
      res = "";
      itot = 0;
      for (i=0; i<iwd; i++)
       { if (itot >= icols)
          { nl++;
            itot = 0;
          }
         itot = itot + words[i].length + 1;
       }
      itot = nl + parl+1;
      if (nrows > itot) { itot = nrows; }
   //  alert(nl+" "+parl+" "+irows+" "+icols+" "+nrows )
      str = str.replace(/\n/g,"\r\n");
      if (itot > irows)
        { msg.rows=itot;  }
      return str;
    }

   function countlines(inStr)
    { var i, n, m;
      n = 0;
      i = 0;
      m = inStr.indexOf("\n",n);
      while (m >= 0)
       { i++;
         n=m+1;
         m = inStr.indexOf("\n",n);
       }
      return i;
  }

 function out(win, text, param)
  { var str, val;
    if (param == "") { return; }
    str = text+": ["+param+"]\n";
    if (whichway == 0)
     { win.document.write(str);
     } else
     { ascii += str;
     }
  }

 function radio(win, param, text, max)
  { var i, val, j;
    j=0;
    for (i=0; i<max; i++)
     { if (param[i].checked)
        { val=param[i].value;
          out(win,text,val);
          j=1;
        }
     }
    if (j == 0) { out(win,text,"") }
   }

 function fradio(param, max)
  { var i, val, j;
    j=0;
    for (i=0; i<max; i++)
     { if (param[i].checked)
        { val=param[i].value;
          j=1;
        }
     }
    if (j == 0) { val = ""; }
    return val;
   }

function fdropdown(param)
  { var indx, val;
    indx = param.selectedIndex;
    val =param.options[indx].value;
    return val;
  }

 function testvalues()
  { var str, Foth;
    str = "";
    Foth = trim(document.forms[0].Oth.value);
    if (Fmsgno == "") { str="Enter a Message Number."; }
    if (Fsever == "") { str=str+"\n Indicate Situation Severity."; }
    if (Fhandling == "") { str=str+"\n Indicate Msg. Handling Order."; }
    if (Ftopos == "") { str=str+"\n Enter a To position."; }
    if (Ffmpos == "") { str=str+"\n Enter a From position."; }
    if (Ftoloc == "") { str=str+"\n Enter a To Location."; }
    if (Ffmloc == "") { str=str+"\n Select a FROM CERT Location."; }
    if (Fsubject == "") { str=str+"\n Enter a Subject."; }
    if (Foth > 0 && orimsg == "") {str=str+"\n Specif in the Message area (12.) what Other means." }
    if (Fmsg == "") { str=str+"\n You must include a Message."; }
 //   if (Frecsent == "") { str=str+"\n Check whether Message is Received or Sent."; }
 //   if (Fmode == "") { str=str+"\n Check mode Receiving or Sending Message."; }
    if (str == "")
     { return true;
     } else
     { datetime(2);
       alert(str);
       return false;
     }
  }
 function checkbox(param)
  { if (param)
     { return "checked";
     } else
     { return "";
     }
  }

function helpwin()
{
 HelpWin = window.open("", null, "height=600,width=700,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
 HelpWin.document.write("<html>\n<head>\n<title>Message Form Instructions</title>\n" +
 "<script language=\"JavaScript\">\n"+
 "  function closMe() { self.close() }\n"+
 "</script>\n"+
"</head>\n"+
"<body bgcolor=\"#ffffff\">\n"+
"<center>\n"+
"<font face=\"\Times New Roman,Serif\">\n"+
"<h3>INSTRUCTIONS FOR USING THE <font color=\"red\">DA Summary</font> MESSAGE FORM<br>\n"+
"<font size=\"-1\" color=\"red\">RED Areas Required</font></h3>\n"+
"</center>\n"+
"This format version of the standard Santa Clara County ICS (Incident Command System) Message Form 213 is "+
"designed for use by a neighborhood CERT group, School District, or Windshield Survey to report the Damage "+
"Summary for their assigned areas. &nbsp; In a major earthquake it is likely that a large number of structures "+
"will be damaged and many people impacted. &nbsp; It will not be practical to send an individual message "+
"for each house damaged or person injured."+
"<p>"+
"A neighborhood Command Post or School District would accumulate incident information on a Damage Assessment "+
"form, then summarize the columns and put their totals on this form.  Over time the totals in the columns will "+
"change, and each subsequent message should report the cumulative totals at the current time."+
"<p><b>NOTE:</b> It is best to use Outpost>Settings>Station ID to input the CERT Tactical call sign and ID information, "+
" then when this form is launched from Outpost, items 1 thru 10 below will be automatically "+
"populated correctly. &nbsp; However, these auto-filled areas may be modified if the situation being reported "+
"is other than the standard auto-filled information.<p>"+
"<ol>\n"+
"<li><b>Date and Time:</b>  When receiving or sending any message, complete the date and time (in the format shown) "+
"in the top upper left of the form. &nbsp; This is the date/time from the IC. &nbsp;Since PacFORMS auto fills this "+
"when the form is loaded, it should be changed to match the IC's date/time.</li>\n"+
"<li><b>When Receiving Message:</b>  note the sending organization's message number in the box labeled \"When Receiving Msg.\", "+
"located to the left of the Msg. # at the top right of the message form. <i>(Normally entered automatically by Outpost or "+
"by radio operator)</i>\n"+
"<br><b>Msg #:</b> This is your sequential message number formatted as, for example,  \"<b>CPA-006</b>\" where \"CPA\" is Cuesta "+
"Park and \"006\" indicates the 6th message sent or received.  Each neighborhood should substitute its own indicator. "+
"<i>Examples: Rex Manor =  REX, Old Mountain View = OMV, etc. </i>. &nbsp;As above, this will automatically be entered by Outpost."+
"<li><b>When Sending Message:</b>  obtain the receiving organization's message number, and record this in the \"When Sending Msg.\" box "+
"located to the right of the Msg. # at the top right of the message form. <i>(Normally entered by radio operator)</i>\n"+
"<li><font color=\"red\"><b>Situation Severity:</b></font> - For a Summary, use \"Other\".\n"+
"<li><font color=\"red\"><b>Message Handling Order:</b></font>- For a Summary use \"Priority\"</i>.\n"+
"<li><b>Message Requests You To:</b> For a Summary, use \"For Your Information\"\n"+
"<li><font color=\"red\"><b>TO:  ICS Position:</b></font> For a Summary, use \"Planning\"\n"+
"&nbsp; <font color=\"blue\">NOTE: If you click on the <i>Display Dropdown List</i>, a dropdown list will appear, \n"+
"that allows you to select an ICS position.  When selected, the dropdown will go back to the single text field,\n"+
" and the selected ICS Position will be copied to the single text field.</font color>\n"+
"<li><font color=\"red\"><b>From: ICS Position:</b></font>  indicate what ICS position is sending the message - "+
"you also can note a name, but an ICS position is needed since the person staffing the position may change.  "+
"<i>For this DA Summary use \"Planning\" or \"IC\"</i>. \n"+
" <font color=\"blue\">NOTE: See NOTE in blue in Item 8 above.  That instruction applies here also.</font color>\n"+
"<li><font color=\"red\"><b>Locations:</b></font>  enter the location of the addressee in the <b>\"To\"</b> box and "+
"the location of the sender in the <b>\"From\"</b> box  (for example, To: MTVEOC or Mountain View EOC, From: <i>your CERT</i>)."+
" &nbsp; <i>Example:</i> Rex Manor, etc. (If already pre-printed, do not change it.)\n"+
"<li><b>Subject:</b>  Note the subject of the message is in two parts. &nbsp; The first part is automatically filled in "+
"by Outpost when the form is loaded. &nbsp;If the CERT team name is missing, enter it in the field to the right. &nbsp; Any other "+
"information may be added if necessary. "+
"<li><b>Reference:</b> <i>For this DA Summary leave blank</i>.\n"+
"<li><b><font color=\"red\">MESSAGE: </font>(Damage Assessment Reports)</b>  Above the Message Textarea, are 16 text boxes that should be used to enter the number "+
"of observations for each Damage Assessment item. &nbsp; Note that the last item should be a Percentage of "+
"neighborhoods that were surveyed up to that time.  You can navigate from text box to text box using the tab key. "+
"&nbsp; This information will be placed into the Message area above any comments added to the Message area when "+
"the form is submitted. &nbsp; <i>A note on the Fires box: report only Actively burning fires.</i>\n"+
"<br><b>Other Info:</b>  If the message is a request for support, supply detailed instructions "+
"about what, when, and where the support is to be delivered. Be as brief as possible.  For example, "+
"Enter top 1-3 incidents From the Damage Assessment with locations and situation details.\n"+
"<li><b>Action Taken:</b>  This section is for use of the message originator or recipient to record pertinent information "+
"regarding action taken in response to the message. (e.g., \"Request for Type 5 Engine Strike Team passed to Region on OASIS Net.\"). "+
"Space is also provided to indicate copy to other ICS positions that may need the information.\n"+
"<li><b>Operator Use:</b>  The person who handled the message is to record the net used in the area at the bottom of "+
"the message form and records the name and call sign in the appropriate box. If the message is being sent, "+
"the date and time that the message actually was sent is to be noted in the relevant box.  <i>For this DA Summary "+
"check \"Other\" and enter \"PACKET\"; This information, including the operator Call Sign and Name will automatically be "+
"filled in by Outpost.</i>\n"+
"<li><b>Forms Disposition:</b> Once the message is complete, copies of the message are distributed according to the script shown. "+
"If the message is an <b><u>EMERGENCY</u></b> message, it should be placed in the hands of the shift supervisor. "+
"For other messages, it is permissible to place the message in the appropriate message box slot.\n"+
"</ol>\n"+
"<p><center>\n<a href=\"JavaScript:closMe()\">Close Window</a>\n</center>\n"+
"</body>\n"+
"</html>\n");
HelpWin.document.close();
}


 function gatherdata()
 {
  document.forms[1].formtext.value = ascii;
  return;
 }

 function poundstuff()
  {  var reqStr = "!PACF! "+pacf+"\n"+"# JS:"+JSid+" \n"+"# "+JSver+" \n"+
                  "# FORMFILENAME: "+geturl()+"\n";
     return reqStr;
  }

 var pacf = "";
 function newwin(theway)
  { datetime(1);
    whichway = theway;
 FRSmsgno = trim(document.forms[0].RSmsgno.value); // TEXT
 Fmsgno = trim(document.forms[0].msgno.value); // TEXT
 FSRmsgno = trim(document.forms[0].SRmsgno.value); // TEXT

 FRSmsgno = FRSmsgno.toUpperCase();
 Fmsgno = Fmsgno.toUpperCase();
 FSRmsgno =FSRmsgno.toUpperCase();

 Fdate = trim(document.forms[0].date.value); // TEXT
 Finfo = checkbox(document.forms[0].info.checked); // CHECKBOX VALUE: info
 Ftime = trim(document.forms[0].time.value); // TEXT
 Fsever = fradio(document.forms[0].sever,3);
 Fhandling = fradio(document.forms[0].handling,3);
 //Ftayn = fradio(document.forms[0].tayn,2);
 //Freplyyn = fradio(document.forms[0].replyyn,2);
 Freplyby = trim(document.forms[0].replyby.value); // TEXT
 Ftopos = trim(document.forms[0].topos.value); // TEXT
 Ffmpos = trim(document.forms[0].fmpos.value); // TEXT
 Ftoloc = trim(document.forms[0].toloc.value); // TEXT
 Ffmloc = trim(document.forms[0].fmloc.value); // TEXT
 Ftoname = trim(document.forms[0].toname.value); // TEXT
 Ffmname = trim(document.forms[0].fmname.value); // TEXT
 Ftotel = trim(document.forms[0].totel.value); // TEXT
 Ffmtel = trim(document.forms[0].fmtel.value); // TEXT
 Fcertsubj = document.forms[0].certsubj.value;
 Fsubject = Fcertsubj+ " " + trim(document.getElementById("subcert").value); // TEXT
 Freference = trim(document.forms[0].reference.value); // TEXT
 Fmsg = loadmessage();
// alert(Fmsg);
// Fmsg = wrap(Fmsg,-50); // removed since this is done later when writing the ascii file
 document.forms[0].msg.value=Fmsg;
 Faction = trim(document.forms[0].action.value); // TEXTAREA
 Faction = wrap(Faction,-50);
 Fmgt = checkbox(document.forms[0].mgt.checked); // CHECKBOX
 Fops = checkbox(document.forms[0].ops.checked); // CHECKBOX
 Fplan = checkbox(document.forms[0].plan.checked); // CHECKBOX
 Flog = checkbox(document.forms[0].log.checked); // CHECKBOX
 Ffin = checkbox(document.forms[0].fin.checked); // CHECKBOX
 Frecsent = fradio(document.forms[0].recsent,2);
 Fmode = fradio(document.forms[0].mode,7);

 Fother = trim(document.forms[0].other.value); // TEXT
 Focall = trim(document.forms[0].ocall.value); // TEXT
 Foname = trim(document.forms[0].oname.value); // TEXT
 // Fodisp = trim(document.forms[0].odisp.value); // TEXT
 Fodate = trim(document.forms[0].odate.value); // TEXT
 Fotime = trim(document.forms[0].otime.value); // TEXT
// Next 5 lines are for added info after !PACF!
   d = "MTV213-CERT";
   a = Fmsgno.substring(0);
   b = Fsever.substring(0,1);
   c = Fhandling.substring(0,1);
   pacf = a+"_"+b+"/"+c+"_"+d+"_"+Fsubject;
//
 if (whichway == 1)
  { ascii = poundstuff();
    NewWin = 0;
  } else
  {
 if ( !testvalues() )  {  return; }

 NewWin = window.open("", null, "height=600,width=700,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
 NewWin.document.write("<"+"html>");
 NewWin.document.write("<"+"head>\n");
 NewWin.document.write("<title>EOC Message Form</title>\n");
 var bbb = Browser();
 if (bbb)
  {
    NewWin.document.write('<SCRIPT LANGUAGE="JavaScript" type="text/javascript">\n');

    NewWin.document.write("function ClipBoard()\n");
    NewWin.document.write(" { \n");
    NewWin.document.write("   holdtext.innerText = copytext.innerText; \n");
    NewWin.document.write("   Copied = holdtext.createTextRange(); \n");
    NewWin.document.write('   Copied.execCommand("Copy"); \n');
    NewWin.document.write(" } \n");

    NewWin.document.write("<"+"/SCRIPT> \n");
  }
 NewWin.document.write("</head> \n");
 if (bbb)
  {
    NewWin.document.write('<'+'body  bgcolor="#ffffff" onLoad="ClipBoard()">\n');
    NewWin.document.write('<SPAN ID="copytext" STYLE="background-color:lightblue">\n');
    NewWin.document.write('<TEXTAREA ID="holdtext" STYLE="display:none;"> </TEXTAREA>\n');
  }
 else
  { NewWin.document.write('<'+'body>\n');
  }
 NewWin.document.write("<pre>\n");
 NewWin.document.write("!PACF! "+pacf+"\n# JS:"+JSid+" \n");
 NewWin.document.write("# "+JSver+"\n");
 NewWin.document.write("# FORMFILENAME: "+geturl()+"\n");

  }  // end of else loop where whichway == 0
//
 listels();

 if (whichway == 0)
  { NewWin.document.write("#EOF\n");
  } else
  { ascii += "#EOF\n";
    gatherdata();
    return;
  }
//
 NewWin.document.write("</pre>\n");
 if (bbb)
  { NewWin.document.write("</SPAN>"); }
 NewWin.document.write("</body>");
 NewWin.document.write("</html>");
 NewWin.document.close();
  }
//
var qsParm = new Array();
var qsVal = new Array();
var qsN;
function qs()
 { var n=0;
   var query = window.location.search.substring(1);
   query = query.replace(/%20/g,"");
   var leng=query.length;
  // alert("Query="+query+", "+leng);
   if (leng <=1) { return; }
   var parms = query.split('&');
   qsN = parms.length;
   for (var i=0; i<qsN; i++)
    {
      var pos = parms[i].indexOf('=');
      if (pos > 0)
       {
         qsParm[i] = parms[i].substring(0,pos);
         qsVal[i] = parms[i].substring(pos+1);
         qsVal[i] = decodeURI(qsVal[i]);
         qsVal[i] = qsVal[i].replace(/\+/g, " ");
       }
    }
   assignq();
 }

 function assignq()
  { var i,j,dum;
    for (i=0; i<qsN; i++)
     {
       if (!document.forms[0][qsParm[i]] )
       { alert(">>> Form Field name \'"+qsParm[i]+"\' does NOT exist.");
       } else
       { document.forms[0][qsParm[i]].value=qsVal[i];
       }
     }
  }

  var ttoggle = 0;
  var ftoggle = 0;
   function ToSwitch()
    {
      if (ttoggle == 0)
       { document.getElementById("tonorm").style.display="none";
         document.getElementById("todrop").style.display="block";
         document.forms[0].b1.value="Display Manual Entry";
         document.forms[0].toposdd[0].selected=true;
         ttoggle = 1;
       }
      else
       { document.getElementById("tonorm").style.display="block";
         document.getElementById("todrop").style.display="none";
         document.forms[0].b1.value="Display Dropdown List";
         ttoggle = 0;
       }
      return false;
    }

   function tbacktonorm()
    { var dum=document.forms[0].toposdd.value;
          document.forms[0].topos.value=dum;
          document.forms[0].b1.value="Display Manual Entry"
          ToSwitch();
    }

   function FmSwitch()
    {
      if (ftoggle == 0)
       { document.getElementById("fmnorm").style.display="none";
         document.getElementById("fmdrop").style.display="block";
         document.forms[0].b2.value="Display Manual Entry";
         document.forms[0].fmposdd[0].selected=true;
         ftoggle = 1;
       }
      else
       { document.getElementById("fmnorm").style.display="block";
         document.getElementById("fmdrop").style.display="none";
         document.forms[0].b2.value="Display Dropdown List";
         ftoggle = 0;
       }
      return false;
    }

   function fbacktonorm()
    { var dum=document.forms[0].fmposdd.value;
          document.forms[0].fmpos.value=dum;
          document.forms[0].b2.value="Display Manual Entry"
          FmSwitch();
    }

// BEGIN SPECIAL JAVASCRIPT FOR CERT/UNIVERSAL MESSAGE FORM
//
  var loaded=0, startmsg="";  // Loaded flags that this function has been run already.
                              // startmsg contains the original msg contents
  var orimsg;
  function loadmessage()
  { var cert="";
    var dum="";
    orimsg = trim(document.forms[0].msg.value);
    if (loaded == 0)
     { startmsg = orimsg;
     } else if (loaded >= 1)
     { orimsg = startmsg;
     }
    if ((dum=trim(document.forms[0].Fire.value)) != "") { cert = cert+"  F"+dum; }
    if ((dum=trim(document.forms[0].GL.value)) != "") { cert = cert+"  G"+dum; }
    if ((dum=trim(document.forms[0].WL.value)) != "") { cert = cert+"  W"+dum; }
    if ((dum=trim(document.forms[0].El.value)) != "") { cert = cert+"  E"+dum; }
    if ((dum=trim(document.forms[0].Ch.value)) != "") { cert = cert+"  C"+dum; }
    if ((dum=trim(document.forms[0].Li.value)) != "") { cert = cert+"  L"+dum; }
    if ((dum=trim(document.forms[0].Mod.value)) != "") { cert = cert+"  Mod"+dum; }
    if ((dum=trim(document.forms[0].He.value)) != "") { cert = cert+"  H"+dum; }
    if ((dum=trim(document.forms[0].Im.value)) != "") { cert = cert+"  I"+dum; }
    if ((dum=trim(document.forms[0].De.value)) != "") { cert = cert+"  D"+dum; }
    if ((dum=trim(document.forms[0].Tr.value)) != "") { cert = cert+"  T"+dum; }
    if ((dum=trim(document.forms[0].Morg.value)) != "") { cert = cert+"  Mor"+dum; }
    if ((dum=trim(document.forms[0].Acc.value)) != "") { cert = cert+"  A"+dum; }
    if ((dum=trim(document.forms[0].NA.value)) != "") { cert = cert+"  N"+dum; }
    if ((dum=trim(document.forms[0].Oth.value)) != "") { cert = cert+"  O"+dum; }
    if ((dum=trim(document.forms[0].NeiS.value)) != "") { cert = cert+"  Nei"+dum; }
    cert = cert+"\n"+orimsg;
//    alert(cert);
    loaded= loaded+1;
    return cert;
  }

   var ltoggle=0;
   function FmLocSwitch()
    {
      if (ltoggle == 0)
       { document.getElementById("fmlocnorm").style.display="none";
         document.getElementById("fmlocdrop").style.display="block";
         document.forms[0].b3.value="Display Manual Entry";
         document.forms[0].fmlocdrop[0].selected=true;
         ltoggle = 1;
       }
      else
       { document.getElementById("fmlocnorm").style.display="block";
         document.getElementById("fmlocdrop").style.display="none";
         document.forms[0].b3.value="Display CERT List";
         ltoggle = 0;
       }
      return false;
    }

 function fixsubj()
  { var cert=document.forms[0].fmlocdrop.value;
    document.forms[0].fmloc.value=cert;
    document.forms[0].certsubj.value="Damage Summary for "+cert;
    document.getElementById("fmlocnorm").style.display="block";
    document.getElementById("fmlocdrop").style.display="none";
    document.forms[0].b3.value="Display CERT List";
    ltoggle = 0;
  }

  function fixsubj1()                // Added 4/27/15
   { var mno = document.forms[0].msgno.value;
     var mno1 = (mno.substr(0,1));
     var mno2 = (mno.substr(0,2));
     var mno3 = (mno.substr(0,3));
    // mno3 = mno3.toUpperCase();
     mno2 = mno2.toUpperCase();
     if (mno1 == "0" || mno2 == "WS")
      { cert = document.forms[0].fmloc.value;
        document.forms[0].fmloc.value=cert;
        document.forms[0].certsubj.value="Damage Summary for "+cert;
      }
     return;
   }

 function listcert(tact,certs)
  { var i;
    i = 0;
    /* Modified 01/23/20 to add Nsg, ID */
    var CertW = window.open("",null, "height=650,width=550,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
    CertW.document.write("<html>\n");
    CertW.document.write("<head>\n");
    CertW.document.write("<title>CERT Areas</title>\n</head>\n</body>\n");
    CertW.document.write("CERT Areas In This Version of the Universal Form<p>\n");
    CertW.document.write("<table><tr><th>TACTICAL CALL &nbsp; &nbsp; &nbsp;</th><th>MSG. ID</th><th>AREA NAME</th></tr>\n");
    do
     { CertW.document.write("<tr><td>MTV"+tact[i]+"</td><td>"+tact[i]+"</td><td>"+certs[i]+"</td></tr>\n");
       i++;
     } while (tact[i] != "");
    CertW.document.write("</table>\n");
    CertW.document.write("<p>"+i+" CERT Areas Listed. &nbsp; -- &nbsp; To print, Type CTRL P\n");
    CertW.document.write("</body>\n</html>\n");
    CertW.document.close();
    return;
  }


    var tact = new Array("APK","ATA","CPR","CPK","GPK","GSA","MLN","MVG","NWA","OMV","REN","REX",
      "SFA","SLA","SMV","SLV","VAR","WWN","MLA","MVW","");

    var certs = new Array("Ada Park","Appletree","Cooper Neighborhood","Cuesta Park","Gemello","Greater San Antonio",
      "Monta Loma","Mtn.View Gardens","North Whisman","Old Mtn. View","Rengstorff/Shoreline","Rex Manor",
      "St. Francis Acres","Slater","South Mountain View","Sylvan Park","Varsity Park",
      "Wagon Wheel","Mtn. View-Los Altos H.S. Dist.","Mtn. View-Whisman School Dist.","");

 function checkmsgno()
  { var i;

   var mno = document.forms[0].msgno.value;
   var mno1 = (mno.substr(0,1));
   var mno2 = (mno.substr(0,2));   // Added 4/27/15
   var mno3 = (mno.substr(0,3));
   mno3 = mno3.toUpperCase();
   mno2 = mno2.toUpperCase();      // Added 4/27/15
   if (mno3 == "*LI")
    { listcert(tact,certs);
      return;
    }
   if (mno1 == "0" || mno2 == "WS")
    { document.forms[0].b3.disabled=false;
      document.forms[0].certsubj.value="Damage Summary for ";
      return;
    }
   if (mno3 == "XXX")
    { alert("The first 3 characters of the message number are XXX \n"+
       "which means that you have not changed the Outpost Tactical ID. \n"+
       "To change the Tactical ID in Outpost, go to Tools->Report \n"+
       "Settings->Variables, and set the correct Tactical ID for your CERT group.");
       document.forms[0].certsubj.value="Damage Summary for ";
       return;
    }
   if (mno3 == "")
    { alert("Message number is blank.");
      document.forms[0].b3.disabled=false;
      document.forms[0].certsubj.value="Damage Summary for ";
      return;
    }
   if (mno3 == "EOC")
    { alert("EOC found in message number.");
      document.forms[0].b3.disabled=false;
      document.forms[0].certsubj.value="Damage Summary for ";
      return;
    }
   i=-1;
   do i++; while ((mno3 != tact[i]) && (tact[i] != ""));
   if (tact[i] == "")
    { alert("The first 3 characters of the message number \n"+
       "are not recognized as a CERT tactical Message ID designation.\n"+
       "You must set a CERT group Tactical Call and Message  ID in Outpost \"Setup\".\n\n"+
       "When you acknowledge this "+
       "notice, a list of the valid 6 letter Tactical Call signs \nand 3 letter Message ID names"+
       " will pop up.\n\nClose this form that you just opened, "+
       "then in Outpost, go to Setup->Station ID,"+
       "\nand set the correct Tactical Call and Message ID. Now, Open this Form again.\n\n"+
       "If the pop-up does not happen, check your "+
       "browser to allow pop-ups.");
      document.forms[0].b3.disabled=false;
      document.forms[0].certsubj.value="Damage Summary for ";
      listcert(tact,certs);
      return;
    }
   document.forms[0].fmloc.value=certs[i];
   document.forms[0].fmloc.disabled=true;
   document.forms[0].certsubj.value="Damage Summary for "+certs[i];
   return;
 }

//END SPECIAL JAVASCRIPT FOR CERT/UNIVERSAL MESSAGE FORM

 function custom()
  { qs(); // Do Not remove this function call. Used by Outpost to pass data.
    document.forms[0].recsent[1].checked=true;
    document.forms[0].mode[6].checked=true;
    document.forms[0].other.value="Packet";

   document.forms[0].sever[2].checked=true;
   document.forms[0].handling[1].checked=true;
   document.forms[0].tayn[1].checked=true;
   document.forms[0].replyyn[1].checked=true;
   document.forms[0].info.checked=true;

   document.forms[0].topos.value="Planning";
   document.forms[0].toloc.value="Mountain View EOC";
   document.forms[0].fmpos.value="Planning";
   document.forms[0].b3.disabled=true;
   checkmsgno();
  // document.forms[0].fmloc.value="Generic CERT ";
  // document.getElementById("subcert").value="Generic ";
  // document.forms[0].msg.value="Fires=  Gas Leak=  Water Leak=  Electrical=  Chemical=\nBldg.: Light=  Mod=  Heavy=\nPeople:Immediate=  Delayed=  Trapped=  Morgue=\nRoads: Access=  No access=  Neighborhood % surveyed=";


  } //End Custom
//
/*
 function reply()
  {  treply = 1;
     Fmsgno = trim(document.forms[0].msgno.value); // TEXT
     FRSmsgno = trim(document.forms[0].RSmsgno.value); // TEXT
     Ftopos = trim(document.forms[0].topos.value); // TEXT
     Ffmpos = trim(document.forms[0].fmpos.value); // TEXT
     Ftoloc = trim(document.forms[0].toloc.value); // TEXT
     Ffmloc = trim(document.forms[0].fmloc.value); // TEXT
     Ftoname = trim(document.forms[0].toname.value); // TEXT
     Ffmname = trim(document.forms[0].fmname.value); // TEXT
     Ftotel = trim(document.forms[0].totel.value); // TEXT
     Ffmtel = trim(document.forms[0].fmtel.value); // TEXT
     Fsubject = trim(document.forms[0].subject.value); // TEXT
     Fmsg = trim(document.forms[0].msg.value); // TEXTAREA\
     Fkeep = checkbox(document.forms[0].keepmsg.checked);
     document.forms[0].reset();
     if (FRSmsgno == "")
       { document.forms[0].reference.value="Your Message No.: "+Fmsgno;
       } else
       { document.forms[0].reference.value="Your Message No.: "+FRSmsgno;
       }
     treply = 0;
     document.forms[0].topos.value=Ffmpos;
     document.forms[0].fmpos.value=Ftopos;
     document.forms[0].toloc.value=Ffmloc;
     document.forms[0].fmloc.value=Ftoloc;
     document.forms[0].toname.value=Ffmname;
     document.forms[0].fmname.value=Ftoname;
     document.forms[0].totel.value=Ffmtel;
     document.forms[0].fmtel.value=Ftotel;
     document.forms[0].subject.value="Re: "+Fsubject;
     document.forms[0].recsent[0].checked=true;
	 document.forms[0].mode[6].checked=true;
     document.forms[0].other.value="Packet";
     datetime(0);
     if ( Fkeep )
      { document.forms[0].msg.value=Fmsg;
      }
   }
*/

function testreply()
  { if (fromlocal > 0 )
    {
      document.getElementById("senddt").style.display="none";
      document.getElementById("outpostdt").style.display="block";
    }
   return;
  }

//  Displays all form field values as a disagnostice tool
  function writeels()
   { var n,typ,val, nam, str, lb, i;

     n = document.forms[0].elements.length;
     javascript:void(window.open());
     Ele = window.open("", null, "height=600,width=700,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
     Ele.document.write("<" + "html>\n" + "<head>\n<title>Element List</title>\n</head>\n");
     Ele.document.write("<" + "body>\n<b>ELEMENT LIST for "+geturl()+"<p>Ele. Index, Type, Name, Value</b><p>");
     for (i=0; i<n; i++)
      { //lb = String.fromCharCode(163); // English pound sign - to flag select index
        lb = "}";
        typ = document.forms[0].elements[i].type;
        nam = document.forms[0].elements[i].name;
        val = document.forms[0].elements[i].value;
        str = i+",  "+typ+", &nbsp; "+nam+",  &nbsp; "+val+", &nbsp; ";
        if (typ == "radio" || typ == "checkbox")
          { chk = document.forms[0].elements[i].checked;
            str = str+"["+chk+"], ";
          }
        if (typ=="select-one")
		 { indx = document.forms[0].elements[i].selectedIndex;
           str = str+lb+indx;
         }
        str = str+",<br>";
        Ele.document.write(str);
      }
    Ele.document.write("</body>\n</html>\n");
    Ele.document.close();
   }

 var inl = new Array();
 var inr = new Array();

 function outels()   //  Used to fill form fields by pac-read
  { var inn, typ, val, indx, nam, chk, nidx, k, lb;
    var dum = new Array();
    lbo= String.fromCharCode(163);
    lb = "}";
    inn = inl.length;
    // alert(inn+" "+inl[0]+" "+ inl[1]);
    for (i=0; i<inn; i++)
     { k = inl[i];
       typ = document.forms[0].elements[k].type;
	   nam = document.forms[0].elements[k].name;
	   if (typ == "radio" || typ == "checkbox")
	     { document.forms[0].elements[k].checked=inr[i];
	     } else if (typ == "text" || typ == "hidden")
	     { document.forms[0].elements[k].value=inr[i];
	     }else if (typ == "textarea")
         {  ms2 = unwrap(inr[i],document.forms[0].elements[k]);
            document.forms[0].elements[k].value=ms2;
	     } else if (typ=="select-one")
	     { if (inr[i].indexOf(lbo) > -1) { lb=lbo; }
	       dum = inr[i].split(lb);
	       indx = dum[1];
	       document.forms[0].elements[k].selectedIndex=indx;
	     }
     }
   testreply();
  }

  function listels()  //  Writes ASCII file when  form is submitted to send to pac-read.
   { var n,typ,val,indx, nam, chk, nidx, k, lb;
     n = document.forms[0].elements.length;
    // lb = String.fromCharCode(163); // English pound sign - to flag select index
     lb = "}";
    //  yen = String.fromCharCode(165); // Yen sign to flag odate or otime parameter
     yen = "{";
     for (i=0; i<n; i++)
      {
        typ = document.forms[0].elements[i].type;
        nam = document.forms[0].elements[i].name;
        if (typ == "radio" || typ == "checkbox")
          { chk = document.forms[0].elements[i].checked;
            out(NewWin,i,chk);
//            test=chk+" "+typ+" "+nam;
//            out(NewWin,i,test);
          } else if (typ == "button")
          { continue;       // Button will not show in Ascii file.
          } else
          {  val = document.forms[0].elements[i].value;
            if (typ == "text" || typ == "textarea" || typ == "hidden")
             { val = trim(val);
               if (nam == "odate" || nam == "otime")
                { val = val+yen+nam;
                }
             }
            if (typ == "textarea")
             { val = wrap(val,-50);
             }
            if (typ=="select-one")
              { indx = document.forms[0].elements[i].selectedIndex;
                val = val+lb+indx;
              }
            out(NewWin,i,val);
          }
      }
    if (document.forms[0].msgno.value == "$$") { writeels(); }
   }


// -->
</SCRIPT>
<!-- PART1 -->
</head>
<body bgcolor="#ffffff" onLoad="hide_message(); datetime(0); custom();">
<!-- PART2 -->
<center>

<form name="theForm" >

<table border="2" width="100%" bordercolor="black"><tr><td>
  <table border="1" width="100%" >
  <tr><td  align="center" rowspan="2">
      <font size="6" face="arial"><b>MV CERT/EOC MESSAGE FORM</b></font><br>
  <font size="2" face="arial">
  <script language="JavaScript">
	      document.write(JShead);
  </script>
  <div class="header">
  PacFORMS adaption of SCCo ICS Form 213
   By Phil Henderson, KF6ZSQ<br>
(This form works with Outpost/OpDirect for Automatic ASCII text save)
<br></font>
<div id="errormessage1" name="errormessage1" align="center">
<font face="arial" color="red"><b><p><p>
<hr color="red" size="3">
JAVASCRIPT IS NOT ENABLED IN THIS BROWSER. <br>
THIS FORM WILL NOT WORK WITHOUT JAVASCRIPT ENABLED.</b></font>
<hr color="red" size="3">
<p><p>
</div>

For Instructions using this form
  <INPUT TYPE="button" VALUE="HELP"  onClick="helpwin()" tabindex=0>
&nbsp; &nbsp; &nbsp;
For a list of CERT Areas
  <INPUT TYPE="button" VALUE="CERT AREAS"  onClick="listcert(tact,certs)" tabindex=0.1>
  <br>

</div>
<!-- PART3 -->
     </td>
     <td  valign="top" align="center"><font face="arial" size="2">
     <b>2.) When Receiving Msg.:<br>Sender's msg. #</b></font><br><hr>
        <input type="text" size=15 name="RSmsgno" tabindex=1 id="RSmsgno" disabled="true" >
        <br />
		   <span style="font-size:8pt">
		   <input type="checkbox" name="unlockmsg1" value="1" onclick="lockUnlockMsg(this)">
		   Unlock msg. nos. 2 &amp; 3
   </span>
     </td>
     <td  valign="top" align="center" >
     <font face="arial" size="2" color="red">
        <b>Msg. #<br><p>
        <input type="text" size=15 name="msgno" tabindex=2 ><p>
        RED Areas Required</b></font></td>

      <td  valign="top" align="center"><font face="arial" size="2">
      <b>3.) When Sending Msg.:<br>Receiver's msg. #</b></font><br><hr>
        <input type="text" size=15 name="SRmsgno" tabindex=3 id="SRmsgno" disabled="true" >
      </td>
   </tr>

   </table>

   <table border="1" width="100%">
   <tr><td  align="center"><b>1a.) Date: (MM/DD/YY)<br>
       <input type="text" name="date" size="8" tabindex=4></td>

   <td rowspan="2" ><font color="red">
     <b>4.) Situation Severity </font><span class="header">(Select One)</span><br>
    <input type="radio" name="sever" value="EMERGENCY" tabindex=6 onClick="emerg()">
      EMERGENCY</b><span class="header"> <br> &nbsp; &nbsp; &nbsp; (e.g., Life Threat)</span><br>
    <input type="radio" name="sever" value="URGENT" tabindex=7>
      <b>URGENT</b><span class="header"><br> &nbsp; &nbsp; &nbsp; (e.g., Property Threat)</span><br>

     <input type="radio" name="sever" value="OTHER" tabindex=8>
      <b>OTHER</b><span class="header"><br> &nbsp; &nbsp; &nbsp; (All Others)</span><br>
    </td>

       <td rowspan="2" ><font color="red">
      <b>5.) Msg. Handling Order </font><span class="header">(Select One)</span></b><br>
        &nbsp; <input type="radio" name="handling" value="IMMEDIATE" tabindex=9><b> IMMEDIATE</b>
        <span class="header">
        <br>&nbsp; &nbsp; &nbsp; &nbsp; (As Soon as Possible)</span><br>
        &nbsp; <input type="radio" name="handling" value="PRIORITY" tabindex=10><b> PRIORITY</b>
        <span class="header">
        <br>&nbsp; &nbsp; &nbsp; &nbsp; (Less Than One Hour)</span><br>
        &nbsp; <input type="radio" name="handling" value="ROUTINE" tabindex=11><b> ROUTINE</b>
        <span class="header">
        <br>&nbsp; &nbsp; &nbsp; &nbsp; (More Than One Hour)</span><br>
       </td>

       <td  rowspan="2"><b>6.) Message Requests You to:<br>
         &nbsp; &nbsp; &nbsp; TAKE ACTION</b><span class="header"> (Check one)<br>
         &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;</span>
         <input type="radio" name="tayn" value="Yes" tabindex=12> <b>Yes
          &nbsp; &nbsp;
         <input type="radio" name="tayn" value="No" tabindex=13> No<br>

         &nbsp; &nbsp; &nbsp; REPLY</b> (Check one)<br>

         <input type="radio" name="replyyn" value="Yes" tabindex=14><b>Yes, by
         <input type="text" name="replyby" size="12" tabindex=15>&nbsp;
         <input type="radio" name="replyyn" value="No" tabindex=16>No<br>
         &nbsp; &nbsp; &nbsp; <input type="checkbox" name="info" value="info" tabindex="16.1">
         &nbsp; FOR YOUR INFO.</b>
         <span class="header">
         <br> &nbsp; &nbsp; &nbsp; &nbsp; (No action required)</span>
       </td>
</tr>

   <tr><td width="20%" align="center"><b>1b.) Time: (24 hr. time)</b><br>
       <input type="text" name="time" size="8" tabindex=5>
       <span class="header">
       <br><font size="2">0001 to 2400<br>2:00 PM = (2+12)=1400 Hrs.</span>
       </td>
   </tr>
  </table>

  <table border="1" width="100%">
   <tr><td rowspan="4" valign="middle" bgcolor="#dddddd"><b>To:</b></td>

       <td ><font color="red"><b>7.) ICS Position: </font><span class="header">(required)</span>
       <br>
	   <center >
	   	<input type="button" onClick="ToSwitch();" id="button" name="b1"  value="Display Dropdown List">
       </center>
       </b> </td><td>
       <span ID="tonorm" style="display:block;">
           <input type="text" name="topos" size="35" tabindex=17>
       </span>
        <span ID="todrop" style="display:none;">
	          <select name="toposdd" onChange="tbacktonorm()">
	            <option value=" " selected>Choose One</option>
	            <option value="Incident Commander">Incident Commander</option>
	            <option value="Operations">Operations</option>
	            <option value="Planning">Planning</option>
	            <option value="Logistics">Logistics</option>
	            <option value="Finance/Admin.">Finance/Admin.</option>
	            <option value="Public Info. Officer">Public Info. Officer</option>
	            <option value="Liaison Officer">Liaison Officer</option>
	            <option value="Safety Officer">Safety Officer</option>
	          </select>
      </span>
      </td>
       <td rowspan="4" valign="middle" bgcolor="#dddddd"><b>From:</b></td>

       <td ><font color="red"><b>8.) ICS Position: </font><span class="header">(required)</span>
	   <center >
	   	<input type="button" onClick="FmSwitch();" id="button" name="b2"  value="Display Dropdown List">
       </center>
       </b> </td><td>
       <span ID="fmnorm" style="display:block;">
           <input type="text" name="fmpos" size="35" tabindex=21>
       </span>

              <span ID="fmdrop" style="display:none;">
	          <select name="fmposdd" onChange="fbacktonorm()">
	            <option value=" " selected>Choose One</option>
	            <option value="Incident Commander">Incident Commander</option>
	            <option value="Operations">Operations</option>
	            <option value="Planning">Planning</option>
	            <option value="Logistics">Logistics</option>
	            <option value="Finance/Admin.">Finance/Admin.</option>
	            <option value="Public Info. Officer">Public Info. Officer</option>
	            <option value="Liaison Officer">Liaison Officer</option>
	            <option value="Safety Officer">Safety Officer</option>
	          </select>
      </span>
      </td>
   </tr>
   <tr><td><font color="red"><b>9a.) Location: </font><span class="header">(required)</span></b>
   </td><td>
         <input type="text" name="toloc" size="35" tabindex=18 autocomplete="on"></td>
       <td><font color="red"><b>9b.) Location: </font><span class="header">(required)</span></b>
       <center >
	     <input type="button" onClick="FmLocSwitch();" id="fmbutton" name="b3"  value="Display CERT List">
       </center>
       </td><td>
         <span ID="fmlocnorm" style="display:block;">
          <input type="text" name="fmloc" size="35" tabindex=22 autocomplete="on" onChange="fixsubj1()">
         </span>
         <div id="fmlocdrop" style="display:none;">
     <select name="fmlocdrop" tabindex=22.1  onChange="fixsubj()">
      <option value="">Select the CERT Group</options>
      <option value="Ada Park">Ada Park</option>
      <option value="Appletree">Appletree</option>
      <option value="Cooper Neighborhood">Cooper Neighborhood</option>
      <option value="Cuesta Park">Cuesta Park</option>
      <option value="Gemello">Gemello</opion>
      <option value="Greater San Antonio">Greater San Antonio</option>
      <option value="Monta Loma">Monta Loma</option>
      <option value="Mtn.View Gardens">Mtn.View Gardens</option>
      <option value="North Whisman">North Whisman</option>
      <option value="Old Mtn. View">Old Mtn. View</option>
      <option value="Rengstorff/Shoreline">Rengstorff/Shoreline</option>
      <option value="Rex Manor">Rex Manor</option>
      <option value="St. Francis Acres">St. Francis Acres</option>
      <option value="Slater">Slater</option>
      <option value="South Mountain View">South Mountain View</option>
      <option value="Sylvan Park">Sylvan Park</option>
      <option value="Varsity Park">Varsity Park</option>
      <option value="Wagon Wheel">Wagon Wheel</option>
      <option value="Mtn. View-Los Altos H.S. Dist.">Mtn. View-Los Altos H.S. Dist.</option>
      <option value="Mtn. View-Whisman School Dist.">Mtn. View-Whisman School Dist.</option>
    </select>



       </div>
         </td>
   </tr>
   <tr>
       <td ><b>Name: <span class="header">(optional)</span></b></td><td>
           <input type="text" name="toname" size="35" tabindex=19></td>
       <td ><b>Name: <span class="header">(optional)</span></b> </td><td>
           <input type="text" name="fmname" size="35" tabindex=23></td>
   </tr>
   <tr><td ><b>Telephone <span class="header">#: (optional)</span></b></td>
       <td><input type="text" name="totel" size="35" tabindex=20></td>
       <td ><b>Telephone <span class="header">#: (optional)</span></b></td>
       <td><input type="text" name="fmtel" size="35" tabindex=24></td>
   </tr>
 </table>

 <table width="100%"><tr><td>
 <div id="nocert1" style="display:block;">
 <font color="red">
  <b>10.) SUBJECT: &nbsp; &nbsp; &nbsp;</font>
   <input type="text" name="certsubj" disabled size="45">
  <input type="text" name="subject" size="45" tabindex=25 id="subcert">
 </div>
 <div id="nocert1a" style="display:none">
  <font color="red">
  <b>10.) SUBJECT: &nbsp; &nbsp; &nbsp;</font>
   <input type="text" name="subject" size="70" tabindex=25 id="subcert2">
 </div>
  <p>11.) REFERENCE (e.g., Number of earlier msg.): <input type="text" name="reference" size="70" tabindex=26>
  <p>
 <div id="nocert2" style="display:block">
 <!--  Start of Addition for CERT Damage Assessment Report -->
 <font color="red">12a.) MESSAGE: </font> Fill in the boxes with your current Damage Assessment column <u>TOTALS</u> and perentage of Neighborhoods <br>
  surveyed at this time.  For "Fires", report only ACTIVELY burning fires.
   <table border="1" id="certstuff">
   <tr><th colspan="5">Fire &amp; Hazzard</th><th colspan="3">Building</th>
       <th colspan="4">People</th><th colspan="2">Roads</th><th rowspan="2"><u>O</u>ther</th><th><u>Nei</u>ghborhood</th></tr>
   <tr align="center"><td><u>F</u>ires</td><td><u>G</u>as Leak</td><td><u>W</u>ater Leak</td><td><u>E</u>lectrical</td>
       <td><u>C</u>hemical</td>
       <td><u>L</u>ight</td><td><u>Mod</u></td><td><u>H</u>eavy</td><td><u>I</u>mmediate</td>
       <td><u>D</u>elayed</td><td><u>T</u>rapped</td><td><u>Mor</u>gue</td><td><u>A</u>ccess</td><td><u>N</u>o access</td>
       <td>% Surveyed</td>
   </tr>
   <tr align="center"><td><input type="text" name="Fire" size="2" tabindex=26.1></td>
       <td><input type="text" name="GL" size="2" tabindex=26.2></td>
       <td><input type="text" name="WL" size="2" tabindex=26.3></td>
       <td><input type="text" name="El" size="2" tabindex=26.4></td>
       <td><input type="text" name="Ch" size="2" tabindex=26.5></td>
       <td><input type="text" name="Li" size="2" tabindex=26.6></td>
       <td><input type="text" name="Mod" size="2" tabindex=26.7></td>
       <td><input type="text" name="He" size="2" tabindex=26.8></td>
       <td><input type="text" name="Im" size="2" tabindex=26.9></td>
       <td><input type="text" name="De" size="2" tabindex=26.10></td>
       <td><input type="text" name="Tr" size="2" tabindex=26.11></td>
       <td><input type="text" name="Morg" size="2" tabindex=26.12></td>
       <td><input type="text" name="Acc" size="2" tabindex=26.13></td>
       <td><input type="text" name="NA" size="2" tabindex=26.14></td>
       <td><input type="text" name="Oth" size="2" tabindex=26.15></td>
       <td><input type="text" name="NeiS" size="2" tabindex=26.16></td>
   </tr>
   </table>

  <p>12b.) Other Info: &nbsp;
  (Top 1 or 2 incidents with locations and situation details.)
  </div>
  <!-- End of Addition for CERT Damage Assessment Report -->

  <div id="nocert1b" style="display:none">
  <p><font color="red">12. Message </font>(what, when, where needed; how long; contact name and phone number) KEEP MSG BRIEF
  </div>
   <textarea rows="3" cols="80" wrap="hard" name="msg" tabindex=27></textarea>

  </td></tr>
 </table>

 <hr>
 <table width="100%" border="1">
  <tr><td bgcolor="#dddddd"><b><font size=+1>13.) Action Taken: </font> (For use by Originator / Recipient)
 <font face="arial" > &nbsp; -&gt; <i>USE SEPARATE MESSAGE FORM IF SENDING REPLY!</i></font>
  </td></tr>
 <tr><td>

  <tr><td><textarea rows="3" cols="80" wrap="soft" name="action" tabindex=28></textarea>
  </td></tr>
  <tr><td>
  <b>CC: <input type="checkbox" name="mgt" value="Yes" tabindex=29> Management &nbsp; &nbsp; &nbsp;
    <input type="checkbox" name="ops" value="Yes" tabindex=30> Operations &nbsp; &nbsp; &nbsp;
    <input type="checkbox" name="plan" value="Yes" tabindex=31> Planning &nbsp; &nbsp; &nbsp;
    <input type="checkbox" name="log" value="Yes" tabindex=32> Logistics &nbsp; &nbsp; &nbsp;
    <input type="checkbox" name="fin" value="Yes" tabindex=33> Finance
   </td></tr>

  <tr><td>
 </table>
 <table border="1" bgcolor="#dddddd"width="100%">
  <tr><td colspan="2"><font size="+1"><b>14.) Operator use Only</b>

   <tr><td  valign="top"><b>How Received
       <input type="radio" name="recsent" value="Received" tabindex=34> &nbsp; or  &nbsp; Sent
       <input type="radio" name="recsent" value="Sent" tabindex=35> &nbsp; (Check One this line and one below)<br>
        &nbsp; <input type="radio" name="mode" value="Telephone" tabindex=36> Telephone
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
        <input type="radio" name="mode" value="Dispatch Center" tabindex=39>
          Dispatch Center
        <br>
        &nbsp; <input type="radio" name="mode" value="EOC Radio" tabindex=37> EOC Radio
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
        <input type="radio" name="mode" value="FAX" tabindex=40> FAX
        &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
        <input type="radio" name="mode" value="Courier" tabindex=41> Courier
        <br>
        &nbsp; <input type="radio" name="mode" value="Amateur Radio" tabindex=38> Amateur Radio
        &nbsp; &nbsp; &nbsp; &nbsp;
        <input type="radio" name="mode" value="Other" tabindex=42> Other
        <input type="text" name="other" size="20" tabindex=43>
        </b>
       </td>
     <td valign="top">
      <table>
       <tr><td><b>Operator Call Sign:</td><td> &nbsp;<input type="text" name="ocall" size="12" tabindex=44></td></tr>
       <tr><td><b>Operator Name:</td><td> &nbsp;<input type="text" name="oname" size="30" tabindex=45></td></tr>
      </table>
<!--
       <tr><td>&nbsp;<td><td> &nbsp;<input type="hidden" name="odisp"></td></tr>
-->
      <div id="senddt" style="display:block;">
       <table>
       <tr><td><b>Date:</b> &nbsp;
       <input type="text" name="odate" size="8" tabindex=46 disabled id="tidt"></td><td>
        <b>Time: &nbsp;
        <input type="text" name="otime" size="8" tabindex=48 disabled id="tidt"> &nbsp; Date/Time updated at Submit</td></tr>
       </table>
      </div>
      <div id="outpostdt" style="display:none;">
       <table>
       <tr><td><b>Date:</b> &nbsp;
        <input type="text" name="ordate" size="8" tabindex=46 disabled id="tidt"></td><td>
         <b>Time: &nbsp;
        <input type="text" name="ortime" size="8" tabindex=48 disabled id="tidt"> &nbsp; Date/Time Received in Outpost</td></tr>
       </table>
      </div>
       </table>
     </td>
   </tr>
   </table>
  <table width="100%"><tr><td>
  <b><u>Outgoing (Sent):</u></b><br>
  <b>Message Originator:</b>
Send the top copy <b>(white)</b> to <b>Radio, yellow</b> to <b>PLANNING</b>, retain the <b>pink</b> copy for originators <b>file</b>.<br>
<b>Radio:</b> After sending, complete Action Taken info. in gray area, keep <b>white</b> for file in <b>Radio</b>.
<br>
 <b><u>Incoming (Received):</u><br>
Radio:</b> After receiving, complete Action Taken info. in gray area, route top copy <b>(white)</b>
to the <b>addressee, pink</b> copy to <b>PLANNING</b>; retain <b>yellow</b> for file in <b>Radio</b>.
<br><b>Addressee;</b> Take approriate action.
<br><div align="right">
<script language="JavaScript">
  document.write(JStail);
</script>

</div>

 </td></tr>
 </table>
</td></tr>
</table>

<hr width="80%">
<!-- PART3.1 -->
<!--  Addition for saving to Outpost -->
</form>
<div class="trailer">
<form name="submitmachine" method="post" action="http://127.0.0.1:9334/send" onSubmit="return testvalues()">

<table width="80%"><tr><td>
<font face="arial" color="red">
Below you will see two SUBMIT buttons.  The one on the left, when Submitted, will
 open a new window with the ASCII text so you can manually capture, copy, paste and
 save the text.  Follow instructions in red in that window.
<p>
The SUBMIT button to the right will automatically transfer the ASCII text extracted
from the form to the Outpost database via via OpDirect.
OpDirect must be running to make this work or nothing is saved.
</font>
</td></tr>
</table>
<hr width="80%">
<p>

<INPUT TYPE="button" VALUE="SUBMIT Message Form: Manual Copy & Save" onClick="newwin(0)" tabindex=49>
<INPUT TYPE="hidden" NAME=formtext VALUE=snafutextnotchanged>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
<input type="SUBMIT" value="SUBMIT Message Form to Outpost" onClick="newwin(1)" tabindex=50>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
<INPUT TYPE="RESET" VALUE="Clear Input" onClick="resetforms();" tabindex=51>
<p>
</form>
</div>
</body>
</html>
<!-- PART4 -->
